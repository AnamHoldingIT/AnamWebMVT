{% extends "users_panel/users_panel_base.html" %}
{% load static %}
{% load jalali %}
{% block title %}ุฏุงุดุจูุฑุฏ | Anam Portal{% endblock %}

{% block nav_dashboard_active %}active{% endblock %}
{% block page_title %}ุฏุงุดุจูุฑุฏ{% endblock %}

{% block user_role %}
  {{ primary_role|default:"ฺฉุงุฑุจุฑ" }}
{% endblock %}

{% block content %}

  <div class="row mb-4 animate-fade-in-up">
    <div class="col-12">
      <div class="card border-0 bg-gradient-dark-green text-white rounded-4 overflow-hidden position-relative shadow-lg hover-scale-subtle transition-base">
        <div class="card-body p-4 p-lg-5 position-relative z-1">
          <h1 class="h3 fw-bold mb-2">ุฎูุด ุขูุฏุฏุ {{ display_name }} ๐</h1>
          <p class="text-white-50 mb-0">
            ุงูุฑูุฒ {{ jalali_today }} ุงุณุช. ูุถุนุช ูพุฑูฺูโูุง: {{ projects_count }} ูพุฑูฺู ูุนุงู ุจุฑุง ุดูุง.
          </p>
        </div>
        <div class="glow-circle position-absolute top-0 start-0 translate-middle moving-glow"></div>
      </div>
    </div>
  </div>

  <div class="row g-4 mb-5 animate-fade-in-up delay-1">
    <div class="col-md-4">
      <div class="card h-100 glass-card hover-lift-special border-white-10 transition-base">
        <div class="card-body p-4 d-flex flex-column">
          <div class="icon-box bg-gold-subtle text-gold rounded-3 mb-3 d-inline-flex align-items-center justify-content-center transition-base"
               style="width: 50px; height: 50px;">
            <i class="bi bi-calendar-plus-fill fs-4 transition-base"></i>
          </div>
          <h3 class="h5 text-white fw-bold">ุซุจุช ุจุฑูุงูู ุฌุฏุฏ</h3>
          <p class="text-white-50 small mb-4 flex-grow-1">ุจุฑูุงููโูุง ุนููุงุช ุฌุฏุฏ ุฑุง ุชุนุฑู ู ุฒูุงูโุจูุฏ ฺฉูุฏ.</p>
          <a href="{% url 'worklog:plans' %}"
             class="btn btn-link text-gold p-0 text-decoration-none fw-bold d-inline-flex align-items-center gap-2 stretched-link footer-link transition-base">
            ุดุฑูุน ุซุจุช <i class="bi bi-arrow-left transition-base"></i>
          </a>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card h-100 glass-card hover-lift-special border-white-10 transition-base">
        <div class="card-body p-4 d-flex flex-column">
          <div class="icon-box bg-info-subtle text-info rounded-3 mb-3 d-inline-flex align-items-center justify-content-center transition-base"
               style="width: 50px; height: 50px;">
            <i class="bi bi-file-earmark-bar-graph-fill fs-4 transition-base"></i>
          </div>
          <h3 class="h5 text-white fw-bold">ุซุจุช ฺฏุฒุงุฑุด ุนููฺฉุฑุฏ</h3>
          <p class="text-white-50 small mb-4 flex-grow-1">ฺฏุฒุงุฑุด ูพุดุฑูุช ุจุฑูุงููโูุง ุฑุง ุซุจุช ฺฉูุฏ.</p>
          <a href="{% url 'worklog:report_list' %}"{# {% url 'users_panel:reports' %} #}
             class="btn btn-link text-info p-0 text-decoration-none fw-bold d-inline-flex align-items-center gap-2 stretched-link footer-link transition-base">
            ุงุฑุณุงู ฺฏุฒุงุฑุด <i class="bi bi-arrow-left transition-base"></i>
          </a>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card h-100 glass-card hover-lift-special border-white-10 transition-base">
        <div class="card-body p-4 d-flex flex-column">
          <div class="icon-box bg-success-subtle text-success rounded-3 mb-3 d-inline-flex align-items-center justify-content-center transition-base"
               style="width: 50px; height: 50px;">
            <i class="bi bi-kanban-fill fs-4 transition-base"></i>
          </div>
          <h3 class="h5 text-white fw-bold">ูุดุงูุฏู ูพุฑูฺูโูุง</h3>
          <p class="text-white-50 small mb-4 flex-grow-1">ุฏุณุชุฑุณ ุจู ูุณุช ฺฉุงูู ูพุฑูฺูโูุง ุฎูุฏุชุงู.</p>
          <a href="{% url 'worklog:projects' %}"{# {% url 'users_panel:projects' %} #}
             class="btn btn-link text-success p-0 text-decoration-none fw-bold d-inline-flex align-items-center gap-2 stretched-link footer-link transition-base">
            ูุณุช ูพุฑูฺูโูุง <i class="bi bi-arrow-left transition-base"></i>
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="row animate-fade-in-up delay-2">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="h6 text-white fw-bold mb-0">ูพุฑูฺูโูุง ุงุฎุฑ</h4>
        <a href="{% url 'worklog:projects' %}"{# {% url 'users_panel:projects' %} #} class="small text-gold text-decoration-none hover-scale transition-base">ูุดุงูุฏู ููู</a>
      </div>

      <div class="card glass-card border-white-10 overflow-hidden">
        <div class="table-responsive">
          <table class="table table-dark table-hover mb-0 bg-transparent align-middle custom-table-hover">
            <thead>
              <tr>
                <th class="bg-transparent text-gold border-bottom border-white-10 py-3 ps-4 small">ูุงู ูพุฑูฺู</th>
                <th class="bg-transparent text-gold border-bottom border-white-10 py-3 small">ููุด ุดูุง</th>
                <th class="bg-transparent text-gold border-bottom border-white-10 py-3 small">ูุถุนุช</th>
                <th class="bg-transparent text-gold border-bottom border-white-10 py-3 pe-4 small">ุชุงุฑุฎ ุนุถูุช</th>
              </tr>
            </thead>
            <tbody>
              {% for m in recent_memberships %}
              <tr class="transition-base">
                <td class="bg-transparent border-bottom border-white-10 py-3 ps-4 small">
                  {{ m.project.title }}
                </td>
                <td class="bg-transparent border-bottom border-white-10 py-3 small text-white-50">
                  {{ m.get_role_display }}
                </td>
                <td class="bg-transparent border-bottom border-white-10 py-3">
                  {% if m.project.is_active %}
                    <span class="badge bg-success bg-opacity-25 text-success rounded-pill fw-normal">ูุนุงู</span>
                  {% else %}
                    <span class="badge bg-secondary bg-opacity-25 text-white-50 rounded-pill fw-normal">ุบุฑูุนุงู</span>
                  {% endif %}
                </td>
                <td class="bg-transparent border-bottom border-white-10 py-3 pe-4 small text-white-50">
                  {{ m.joined_at|jalali_date }}
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="4" class="text-center py-4 text-white-50">ูุนูุงู ูพุฑูฺูโุง ุจุฑุง ุดูุง ุซุจุช ูุดุฏู.</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

    </div>
  </div>

{% endblock %}
